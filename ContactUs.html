<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Join our Program - The Chess Gurus</title>
    <link href="https://fonts.googleapis.com/css2?family=Magik:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script src="https://www.google.com/recaptcha/api.js?render=6LeSdiIrAAAAAO6dyAsRfzQGHB7MdygEiB0iY-__"></script>
    <style>
        /* ... (Keep all your existing CSS styles here) ... */
         body {
             margin: 0;
             font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
             background-color: #f6e3bb; /* Match index.html background color */
             color: #333;
             overflow-y: scroll; /* Always show vertical scrollbar to prevent nav shift */
         }

        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background-color: #333; 
            color: white; 
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 20px;
            z-index: 1000;
        }

        nav a {
            color: white; 
            text-decoration: none;
            padding: 8px 12px;
            font-weight: bold; 
        }

        nav a:hover {
            background-color: #575757; 
            border-radius: 5px; 
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
            font-weight: bold;
            font-size: 20px;
        }

        .logo img {
            width: 40px; /* Updated size */
            height: 40px;
            border-radius: 50%; /* Make logo rounded */
            margin-right: 10px;
        }

        .logo span {
            font-size: 20px; /* Updated font size */
            font-weight: bold; /* Added font weight */
        }

        .nav-items {
            display: flex;
            gap: 20px;
            align-items: center;
            padding-right: 40px; /* Add space to prevent "Join Now" from being cut off */
        }

        .nav-items a {
            color: white;
            text-decoration: none;
            font-weight: bold;
            padding: 8px;
            transition: background-color 0.3s ease;
        }

        .nav-items a:hover {
            background-color: #575757;
            border-radius: 5px;
        }

        .dropdown {
            position: relative;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            top: 25px; /* Move the dropdown box closer to the parent element */
            background-color: #444; /* Updated dropdown background color */
            min-width: 160px;
            z-index: 1;
            border-radius: 5px; /* Added border radius */
        }

        .dropdown-content a {
            padding: 10px;
            text-decoration: none;
            display: block;
            color: white;
        }

        .dropdown-content a:hover {
            background-color: #575757; /* Updated hover background color */
        }

        .dropdown:hover .dropdown-content,
        .dropdown-content:hover {
            display: block;
        }

        /* Hamburger button */
        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
        }

        .hamburger div {
            width: 25px;
            height: 3px;
            background: white;
            margin: 4px 0;
        }

         @media (max-width: 768px) {
             .nav-items {
                 display: none;
                 flex-direction: column;
                 background-color: #333;
                 position: absolute;
                 top: 60px;
                 right: 0;
                 width: 200px;
                 padding: 10px 0;
             }

             .nav-items.active {
                 display: flex;
             }

             .hamburger {
                 display: flex;
             }
         }

         .contact-header {
             font-size: 36px;
             font-weight: bold;
             text-align: center;
             margin-top: 80px; /* Adjusted margin-top to account for fixed nav */
             padding-top: 20px; /* Added padding top */
         }

         .contact-paragraph {
             font-size: 18px;
             line-height: 1.6;
             text-align: center;
             margin: 20px auto;
             max-width: 700px;
             padding: 0 20px;
         }

         .contact-form-container {
             display: flex;
             flex-direction: column;
             align-items: center;
             gap: 40px;
             max-width: 800px;
             margin: 40px auto;
             padding: 0 20px; /* Add padding for smaller screens */
         }

         form {
             display: flex;
             flex-direction: column;
             gap: 15px;
             width: 100%;
         }

         label {
             font-weight: bold;
         }

         input, textarea {
             padding: 10px;
             border: 1px solid #ccc;
             border-radius: 5px;
             font-size: 16px;
         }

         button {
             background-color: #333;
             color: white;
             padding: 12px 20px;
             font-size: 16px;
             border: none;
             border-radius: 5px;
             cursor: pointer;
             transition: background-color 0.3s ease;
         }

         button:hover {
             background-color: #555;
         }

         h3 {
             font-size: 24px;
             color: #333;
             text-align: center;
         }

         .social-icons {
             display: flex;
             justify-content: center;
             gap: 40px;
             align-items: center;
             margin: 0;
         }

         .social-icons a img {
             width: 50px;
             height: 50px;
         }

         @media (max-width: 900px) {
            .contact-form-container {
                max-width: 98vw;
                padding: 0 2vw;
            }
        }
        @media (max-width: 600px) {
            nav {
                flex-direction: column;
                align-items: flex-start;
                padding: 10px 5px;
            }
            .logo {
                margin-bottom: 10px;
            }
            .nav-items {
                flex-direction: column;
                gap: 10px;
                width: 100%;
                overflow-x: auto;
                padding-right: 0;
            }
            .contact-header {
                font-size: 26px;
                margin-top: 70px;
                padding-top: 10px;
            }
            .contact-paragraph {
                font-size: 15px;
                padding: 0 5vw;
            }
            .contact-form-container {
                gap: 20px;
                margin: 20px auto;
                padding: 0 2vw;
            }
            form {
                gap: 10px;
            }
            input, textarea {
                font-size: 15px;
                padding: 8px;
            }
            button {
                font-size: 15px;
                padding: 10px 10px;
            }
            .social-icons a img {
                width: 36px;
                height: 36px;
            }
        }
    </style>
</head>
<body>
    <nav>
        <div class="logo">
            <img src="images/chessguru.webp" alt="GuruLogo">
            <span>The Chess Gurus</span>
        </div>

        <div class="hamburger" onclick="toggleMenu()">
            <div></div>
            <div></div>
            <div></div>
        </div>

        <div class="nav-items" id="nav-items">
            <a href="index.html">Home</a>
            <div class="dropdown">
                <a href="javascript:void(0);">About Us ▾</a>
                <div class="dropdown-content">
                    <a href="OurMission.html">Our Mission</a>
                    <a href="OurImpact.html">Our Impact</a>
                </div>
            </div>
            <div class="dropdown">
                <a href="javascript:void(0);">Our Team ▾</a>
                <div class="dropdown-content">
                    <a href="OurFounders.html">Our Founders</a>
                    <a href="OurCoaches.html">Our Coaches</a>
                </div>
            </div>
            <div class="dropdown">
                <a href="javascript:void(0);">Coaches ▾</a>
                <div class="dropdown-content">
                    <a href="./ChessHoursSubmission">Volunteer Hours Submission</a>
                    <a href="./CoachApplication">Coach Application</a> 
                </div>
            </div>
            <a href="ContactUs.html">Join Now</a>
            <a href="Gallery.html">Gallery</a>
        </div>
    </nav>


    <div class="contact-header">Join our Program</div>

    <div class="contact-paragraph">
        At AZChessGurus, our goal is to make chess accessible to everyone—and our free lessons program is a great example of that mission in action. We welcome students of all experience levels, from complete beginners to advanced players, and all lessons are offered at no cost. If you’re interested in free lessons, please fill out the form below. A coach from the AZChessGurus team will contact you to schedule your sessions.
    </div>

    <div class="contact-form-container">
        <form id="join-form">
            <label for="fullname">Full Name (required):</label>
            <input type="text" id="fullname" name="fullname" required>

            <label for="email">Your Email (required):</label>
            <input type="email" id="email" name="email" required>

            <label for="phone">Phone Number (required):</label>
            <input type="text" id="phone" name="phone" required>

            <label for="uscf">USCF Rating (if applicable):</label>
            <input type="text" id="uscf" name="uscf">

            <label for="fide">FIDE Rating (if applicable):</label>
            <input type="text" id="fide" name="fide">

            <label for="online">Online Rating (if applicable):</label>
            <input type="text" id="online" name="online">

            <label for="experience">How long have you been playing? (required):</label>
            <textarea id="experience" name="experience" required></textarea>

            <button type="submit" name="submit">Send Message</button>
        </form>

        <div>
            <h3>Social Media</h3>
            <div class="social-icons">
                 <a href="https://www.instagram.com/azchessgurus" target="_blank">
                    <img src="images/instalogo.png" alt="Instagram">
                </a>
                <a href="https://www.youtube.com/@AZChessGurus" target="_blank"> <img src="images/ytlogo.png" alt="YouTube">
                </a>
                <a href="https://www.linkedin.com/in/az-chessgurus-b73740319/" target="_blank">
                    <img src="images/linklogo.png" alt="LinkedIn">
                </a>
                <a href="mailto:chessgurusaz@gmail.com">
                    <img src="images/maillogo.png" alt="Gmail">
                </a>
                <a href="https://discord.gg/Nxmx5KsBdx" target="_blank">
                    <img src="images/discord.png" alt="Discord" style="width:60px;height:60px;">
                </a>
            </div>
        </div>
    </div>

    <script>
        function toggleMenu() {
            const nav = document.getElementById("nav-items");
            nav.classList.toggle("active");
        }

        document.addEventListener("DOMContentLoaded", function () {
            console.log("DOM loaded.");

            // --- EmailJS Initialization ---
            if (typeof emailjs === 'undefined') {
                console.error("EmailJS failed to load.");
                alert("Error initializing contact form. Please try again later.");
                return;
            }
            try {
                 // IMPORTANT: Replace with YOUR EmailJS Public Key
                emailjs.init("6LXXHvwLH9-XLJ2Xg");
                console.log("EmailJS Initialized.");
            } catch (error) {
                console.error("EmailJS initialization failed:", error);
                alert("Error initializing contact form. Please try again later.");
                return;
            }

            // --- reCAPTCHA v3 Configuration ---
            // IMPORTANT: Replace with YOUR ACTUAL reCAPTCHA v3 SITE KEY
            const RECAPTCHA_SITE_KEY = '6LeSdiIrAAAAAO6dyAsRfzQGHB7MdygEiB0iY-__';

            // --- Form Handling ---
            const form = document.getElementById("join-form");
            const submitButton = form.querySelector('button[type="submit"]'); // Get the submit button

            if (form && submitButton) {
                form.addEventListener("submit", function (e) {
                    e.preventDefault(); // Prevent default form submission

                    // Disable button to prevent multiple submissions
                    submitButton.disabled = true;
                    submitButton.textContent = 'Sending...';

                    console.log("Form submitted. Executing reCAPTCHA...");

                    // Check if grecaptcha is loaded
                    if (typeof grecaptcha === 'undefined' || typeof grecaptcha.execute === 'undefined') {
                         console.error("reCAPTCHA script not loaded correctly.");
                         alert("reCAPTCHA error. Please refresh the page and try again.");
                         submitButton.disabled = false; // Re-enable button
                         submitButton.textContent = 'Send Message';
                         return;
                     }

                    grecaptcha.ready(function() {
                        grecaptcha.execute(RECAPTCHA_SITE_KEY, {action: 'submit_join_form'}) // Use a descriptive action name
                            .then(function(token) {
                                console.log("reCAPTCHA token received:", token);

                                // Collect form data
                                const data = {
                                    fullname: form.fullname.value,
                                    email: form.email.value,
                                    phone: form.phone.value,
                                    uscf: form.uscf.value,
                                    fide: form.fide.value,
                                    online: form.online.value,
                                    experience: form.experience.value,
                                    'g-recaptcha-response': token // Include the token in the data sent to EmailJS
                                };

                                // --- Send Email via EmailJS ---
                                // IMPORTANT: Replace with YOUR EmailJS Service ID and Template ID
                                const SERVICE_ID = "service_gsn0pdo";
                                const TEMPLATE_ID = "template_oo2n46g";

                                console.log("Sending data via EmailJS:", data);

                                emailjs.send(SERVICE_ID, TEMPLATE_ID, data)
                                    .then(() => {
                                        console.log("EmailJS success.");
                                        alert("We have received your information! Please give us 3-5 business days for us to get back with you regarding further information to join the program! Hope to meet you soon!");
                                        form.reset();
                                    }, (error) => {
                                        console.error("EmailJS failed:", error);
                                        alert("Failed to send message. Please check your connection or try again later.\nError: " + JSON.stringify(error));
                                    })
                                    .finally(() => {
                                         // Re-enable button regardless of success or failure
                                         submitButton.disabled = false;
                                         submitButton.textContent = 'Send Message';
                                    });

                            })
                            .catch(function(error) {
                                console.error("reCAPTCHA execution failed:", error);
                                alert("Could not verify you're human. Please refresh the page and try again.");
                                // Re-enable button on reCAPTCHA error
                                submitButton.disabled = false;
                                submitButton.textContent = 'Send Message';
                            });
                    });
                });
            } else {
                console.warn("Form with ID 'join-form' or its submit button not found.");
            }
        });
    </script>
</body>
</html>
